<?php
$API = new API();
?>
<div class="card shadow mb-4">
    <div class="card-header py-3">
    <h6 class="m-0 font-weight-bold text-primary">Service Budget</h6>
    </div>
    <div class="card-body">
        <div class="row mb-2">
            <?php
            $get_data = $API->callAPI('GET', 'localhost/api/service_budget.php?view=false&data=project&status=draft', false);
            $response = json_decode($get_data, true);
            $error_draft = $API->check_error($response);
            if($error_draft==200) {
                $tdraft = count($response['data']);
            } else {
                $tdraft = "E" . $error_draft;
            }
            ?>
            <div class="col-sm-3" style="font-size:12px">Draft <span class="badge badge-dark badge-counter bg-success"><?php echo $tdraft; ?></span></div>
            <?php
            $get_data = $API->callAPI('GET', 'https://msizone.mastersystem.co.id/api/service_budget.php?view=true&data=project&status=submited', false);
            $response = json_decode($get_data, true);
            $error_submited = $API->check_error($response);
            if($error_submited==200) {
                $tsubmited = count($response['data']);
            } else {
                $tsubmited = "E" . $error_draft;
            }
            ?>
            <div class="col-sm-3" style="font-size:12px">Submit <span class="badge badge-dark badge-counter bg-info"><?php echo $tsubmited; ?></span></div>
            <?php
            $get_data = $API->callAPI('GET', 'https://msizone.mastersystem.co.id/api/service_budget.php?view=true&data=project&status=rejected', false);
            $response = json_decode($get_data, true);
            $error_rejected = $API->check_error($response);
            if($error_rejected==200) {
                $trejected = count($response['data']);
            } else {
                $trejected = "E" . $error_draft;
            }
            ?>
            <div class="col-sm-3" style="font-size:12px">Rejected <span class="badge badge-dark badge-counter bg-danger"><?php echo $trejected; ?></span></div>
            <?php
            $mdlname = "NAVISION";
            $DBLD = get_conn($mdlname);
            $tblname = "mst_orders";
            $condition = "(isnull(status_sb) OR status_sb='0')";
            $tdoc = $DBLD->get_data($tblname, $condition);
            ?>
            <div class="col-sm-3" style="font-size:12px">SO <span class="badge badge-dark badge-counter bg-warning text-dark"><?php echo $tdoc[2]; ?></span></div>
        </div>
    </div>
</div>
